<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Build our own reference genome - Vulture Tutorial</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Build our own reference genome";
        var mkdocs_page_input_path = "3. Building your reference genome/1_Build.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Vulture Tutorial
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Welcome</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">1. Running on local computer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Running%20on%20local%20computer/1_Quickstart/">Quick start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Running%20on%20local%20computer/2_Commandline/">Command line tool parameters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Running%20on%20local%20computer/3_Nextflow/">Nextflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../1.%20Running%20on%20local%20computer/4_Docker/">Docker</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">2. Running on AWS Cloud</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../2.%20Running%20on%20AWS%20Cloud/1_Setup/">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../2.%20Running%20on%20AWS%20Cloud/2_Nextflow/">Nextflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../2.%20Running%20on%20AWS%20Cloud/3_Batch/">Batch</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../2.%20Running%20on%20AWS%20Cloud/4_RunVulture/">Running Vulture on AWS cloud with Nextflow</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">3. Building your reference genome</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Build our own reference genome</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#download-the-input-data-for-mkref-stage">Download the input data for mkref stage</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Supplementary</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Supplementary/Launchtemp/">Launch template Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Supplementary/Supplementary/">Supplementary</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Vulture Tutorial</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>3. Building your reference genome &raquo;</li>
      <li>Build our own reference genome</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="build-genome-reference">Build Genome reference</h1>
<h2 id="requirements"><a name="require"></a>Requirements</h2>
<ul>
<li>Docker</li>
</ul>
<p>Please refer to Section <a href="https://hiyin.github.io/vulture-user-tutorial/1.%20Running%20on%20local%20computer/4_Docker/">1.Docker</a> or <a href="https://docs.docker.com/engine/install/ubuntu/">Docker</a> for installation.</p>
<p>Now we are about to run the first step of the Vulture pipeline i.e. mkref (genome reference making), execute the command below in your favourite terminal or powershell and wait it to be finished.</p>
<h2 id="download-the-input-data-for-mkref-stage">Download the input data for mkref stage</h2>
<p>The input data required for mkref stage are available in the downloadable links below, you can save them into your own S3 bucket folder:</p>
<ul>
<li>
<p>The human genome : <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/humangenome/hg38.fa">hg38.fa</a></p>
</li>
<li>
<p>The human genome annotation : <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/humangenome/hg38.unique_gene_names.gtf">hg38.unique_gene_names.gtf</a></p>
</li>
<li>
<p>The list of human-host microbe genome : <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/humangenome/prokaryotes.csv">prokaryotes.csv</a></p>
</li>
<li>
<p>The list of human-host virus genome : <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/humangenome/viruSITE_human_host.txt">viruSITE_human_host.txt</a></p>
</li>
</ul>
<p>Alternatavly, you can generate the files yourself following instructions below:</p>
<p><a href="http://virusite.org/index.php?nav=search&amp;fields=1&amp;query1=Human&amp;wc1=on&amp;field1=virus.host&amp;search=Search&amp;query2=&amp;wc2=on&amp;field2=virus.name&amp;query3=&amp;wc3=on&amp;field3=virus.name&amp;search_nav=virus&amp;sort=name&amp;order=asc&amp;rows=25&amp;page=1">VirusSITE</a>
(viruSITE human host)
Click "Format: CSV"</p>
<p><a href="https://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes/">NCBI Prokaryotes</a>
Filters -&gt; Host (Homo sapiens) -&gt; Assembly level (Complete) -&gt; RefSeq category (representative) -&gt; Download [prokaryotes.csv]</p>
<p>Notice that you can edit the of virus or Prokaryotes in viruSITE_human_host.txt and prokaryotes.csv by any text editor to further customize the genome. Then, the folder of your reference input should have the following files:</p>
<pre><code class="language-shell">#The input path e.g. /home/user/data/refinput should have:
hg38.fa  hg38.unique_gene_names.gtf  prokaryotes.csv  viruSITE_human_host.txt
</code></pre>
<p>We then edit the mkref profile in the Vulture/nextflow/nextflow.config:</p>
<pre><code class="language-shell">...
    mkref {
        process.container = 'public.ecr.aws/b6a4h2a6/scvh_mkref:latest'
        docker.enabled = true
        params.ref = '[The full path of you pull your reference genome input, e.g. /home/user/data/refinput]'
        params.humanfa = 'hg38.fa'
        params.humagtf = 'hg38.unique_gene_names.gtf'
        params.viruSITE = 'viruSITE_human_host.txt'
        params.prokaryotes = 'prokaryotes.csv'
        params.outdir = '[The full path of you pull your reference genome output, e.g. /home/user/data/genome]'
        docker.fixOwnership = true
        docker.containerOptions = &quot;--user root&quot;
    }  
...

</code></pre>
<p>Afterwards, run the following command to make your own reference genome:</p>
<pre><code class="language-shell">nextflow run scvh_mkref.nf -profile mkref -with-report mkref_$(date +%s).html -bg &amp;&gt;&gt; mkref_$(date +%s).log;
</code></pre>
<p>The output files should be in the folder you specified in the nextflow.config file, e.g. /home/user/data/genome. There will be a subfolder named "newref" in the output folder, which contains the following files:</p>
<pre><code class="language-shell">3M-february-2018.txt
737K-august-2016.txt
human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.fa
human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.removed_amb_viral_exon.gtf
human_host_viruses_reference_set
</code></pre>
<p>These files can be the input of the next step of the Vulture pipeline. They are also available in the downloadable links below:</p>
<ul>
<li>Hg38 human genome with virus and microbes: <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.fa">human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.fa</a></li>
<li>Hg38 human genome with virus: <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/human_host_viruses.viruSITE.with_hg38.fa">human_host_viruses.viruSITE.with_hg38.fa</a></li>
<li>Hg38 human genome annotaion with virus and microbes: <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.removed_amb_viral_exon.gtf">human_host_viruses_microbes.viruSITE.NCBIprokaryotes.with_hg38.removed_amb_viral_exon.gtf</a></li>
<li>Hg38 human genome annotaion with virus: <a href="https://vulture-reference.s3.ap-east-1.amazonaws.com/human_host_viruses.viruSITE.with_hg38.removed_amb_viral_exon.gtf">human_host_viruses.viruSITE.with_hg38.removed_amb_viral_exon.gtf</a></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../2.%20Running%20on%20AWS%20Cloud/4_RunVulture/" class="btn btn-neutral float-left" title="Running Vulture on AWS cloud with Nextflow"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../Supplementary/Launchtemp/" class="btn btn-neutral float-right" title="Launch template Setup">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../2.%20Running%20on%20AWS%20Cloud/4_RunVulture/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../Supplementary/Launchtemp/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
